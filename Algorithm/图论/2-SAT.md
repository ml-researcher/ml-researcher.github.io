# 2-SAT

## 介绍

n个数，每个数必须从0/1之间选一个，并且还有一些其他限制条件，让找出可行方案

## 解决方法

根据限制条件建立有向图，有向边代表“推导出”，即如果选a就必须需要选b，就连一条(a, b)的边。（0/1也可以理解为选或者不选）

常见的限制条件：

* a, b不能同时选：(a, b'); (b, a')
* a, b必须同时选：（a, b）; (b, a)
* a, b至少选一个：(a', b); (b', a)
* a必须选：(a', a)
* a, b必须恰好选一个：a, b至少选一个 且 a, b不能同时选

最后，根据建出来的图跑强连通分量，如果有任何一个数的0/1在同一个scc里，则有矛盾。否则就有方案。

* [例题](http://poj.org/problem?id=3678)
	* [AC代码](http://lvqingsong.info/pastebin/view/a709a1da)

上面的例题就是很裸的限制条件，有时候重点在于抽象出模型，并建图，也就是说有各种变形的限制条件，需要自己去判断如何建边。

## 构造方案

### 一组可行解

缩点，按照拓扑排序的逆序染色。

首先缩点很好理解，一个强连通分量里的点是捆绑的，要么都选，要么都不选。缩点以后变成了DAG，如何给每个点分配选或者不选呢？

需要找一个起始点选了，选一个scc的后果是什么？在DAG里它的所有后继都要选，这就是后果。那么有没有选了以后一定不会发生严重后果（出现矛盾）的scc呢？有，出度为0的scc。

现在有一个good start了，选了这个scc以后再做什么呢？把与它有矛盾的点对应的scc强制不选，然后再找到下一个出度为0的点，而这个顺序其实就是原图的拓扑序逆序。

按上面的方法构造一定是没有矛盾的可行解（前提是已经判断存在可行解了），更严格的证明可以用反证法。

* [例题](http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=24&page=show_problem&problem=4137)
	* [AC代码](http://lvqingsong.info/pastebin/view/04a7996d)

### 字典序最小解

这个问题实际上引出了2-SAT的另一种解法，这个解法的正确性并没有那么直观，刘汝佳老师的书上写的“可证，这样是对的”，因为我暂时懒得研究如何证~~（也不会证）~~，就只能相信这是对的了。

具体操作就是连Tarjan都不用了，直接for一遍，只要还没染色，就尝试用dfs染色，先尝试染0，如果不行再尝试染1，如果还不行就GG。不必回溯。

* [例题](http://acm.hdu.edu.cn/showproblem.php?pid=1814)
	* [AC代码](http://lvqingsong.info/pastebin/view/b56005d4)

## 参考资料

* https://blog.sengxian.com/algorithms/2-sat