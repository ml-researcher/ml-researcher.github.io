# 最短路进阶

## 差分约束系统

如果一个问题可以转化成求解一组形如$x_i - x_j \le d$的不等式，那么这个问题就可以用差分约束系统来解决。具体来说，如果$x_i - x_j \le d$，就从第j个点连向第i个点一条权值为d的边。最后给建出来的图以任意一个点为起点求单源最短路，得到的每个点的最短路就是一组可行解。

* 判断无解的条件：有负环。
* 判断差值可以无限大的条件：最短路为无穷大。

有时候题目也会让求某两个数的差值最大的那组解。如果要让$x_i - x_j$最大，就以j为起点的最短路即可。

变形：
* 如果让绝对值最大呢？就做两次，分别以i为起点和以j为起点，然后结果求max。
* 如果让差值最小呢？转换为相反数最大。

## 高维最短路

实际上是跟DP有些类似，需要有对状态的感觉，跟DP不同的是，不是要对状态进行求解，而是要求状态间的最短路。[详解](http://codeforces.com/blog/entry/45897)

* [例题](http://poj.org/problem?id=1724)
    * [AC代码](http://lvqingsong.info/pastebin/view/b59980c6)

## 分层图最短路




## 次短路

### 思路1

求两点间的次短路，依次破坏最短路上的边，再求最短路，最后取min，得到的就是次短路。

### 思路2

枚举每条边(i, j)，d[1][i] + w(i, j) +d[i][n]，如果大于最短路，或者是第二次遇到的最短路，则更新次短路。

### 思路3

上面两个思路都太naive了。直接基于Dijkstra都思想，维护同时维护最短路和次短路就可以了。